[2024-07-07T14:45:49.423+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-07T14:45:49.461+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: clickhouse_etl_dag.extract manual__2024-07-07T14:45:43.535381+00:00 [queued]>
[2024-07-07T14:45:49.478+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: clickhouse_etl_dag.extract manual__2024-07-07T14:45:43.535381+00:00 [queued]>
[2024-07-07T14:45:49.481+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 0
[2024-07-07T14:45:49.508+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): extract> on 2024-07-07 14:45:43.535381+00:00
[2024-07-07T14:45:49.518+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=632) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-07T14:45:49.520+0000] {standard_task_runner.py:63} INFO - Started process 634 to run task
[2024-07-07T14:45:49.520+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'clickhouse_etl_dag', 'extract', 'manual__2024-07-07T14:45:43.535381+00:00', '--job-id', '42', '--raw', '--subdir', 'DAGS_FOLDER/clickhouse.py', '--cfg-path', '/tmp/tmpa7yd_zc7']
[2024-07-07T14:45:49.523+0000] {standard_task_runner.py:91} INFO - Job 42: Subtask extract
[2024-07-07T14:45:49.598+0000] {task_command.py:426} INFO - Running <TaskInstance: clickhouse_etl_dag.extract manual__2024-07-07T14:45:43.535381+00:00 [running]> on host dfb367ef2d3b
[2024-07-07T14:45:49.779+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='franklinnwosu008@gmail.com' AIRFLOW_CTX_DAG_OWNER='Ifeanyi_DArTech_Org' AIRFLOW_CTX_DAG_ID='clickhouse_etl_dag' AIRFLOW_CTX_TASK_ID='extract' AIRFLOW_CTX_EXECUTION_DATE='2024-07-07T14:45:43.535381+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-07-07T14:45:43.535381+00:00'
[2024-07-07T14:45:49.782+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-07T14:45:49.808+0000] {connection.py:399} INFO - Snowflake Connector for Python Version: 3.10.1, Python Version: 3.12.4, Platform: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[2024-07-07T14:45:49.811+0000] {connection.py:1239} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-07-07T14:45:50.464+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2024-07-07T14:45:50.546+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2024-07-07T14:45:50.628+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2024-07-07T14:45:50.688+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2024-07-07T14:45:50.764+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2024-07-07T14:45:50.768+0000] {logging_mixin.py:188} INFO - 2015-01-02
[2024-07-07T14:45:50.868+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-07T14:45:50.869+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/modules/extract.py", line 40, in fetch_data
    output = client.query(query)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/clickhouse_connect/driver/client.py", line 208, in query
    return self._query_with_context(query_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/clickhouse_connect/driver/httpclient.py", line 219, in _query_with_context
    response = self._raw_request(body,
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/clickhouse_connect/driver/httpclient.py", line 448, in _raw_request
    self._error_handler(response)
  File "/home/airflow/.local/lib/python3.12/site-packages/clickhouse_connect/driver/httpclient.py", line 371, in _error_handler
    raise OperationalError(err_str) if retried else DatabaseError(err_str) from None
clickhouse_connect.driver.exceptions.DatabaseError: HTTPDriver for https://github.demo.trial.altinity.cloud:8443 returned response code 400)
 Code: 62. DB::Exception: Syntax error: failed at position 175 ('}') (line 4, col 45): }) + 1
        
 FORMAT Native. Expected colon between name and type. (SYNTAX_ERROR) (version 24.5.3.5 (official build))

[2024-07-07T14:45:50.894+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=clickhouse_etl_dag, task_id=extract, run_id=manual__2024-07-07T14:45:43.535381+00:00, execution_date=20240707T144543, start_date=20240707T144549, end_date=20240707T144550
[2024-07-07T14:45:50.919+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 42 for task extract (HTTPDriver for https://github.demo.trial.altinity.cloud:8443 returned response code 400)
 Code: 62. DB::Exception: Syntax error: failed at position 175 ('}') (line 4, col 45): }) + 1
        
 FORMAT Native. Expected colon between name and type. (SYNTAX_ERROR) (version 24.5.3.5 (official build))
; 634)
[2024-07-07T14:45:50.945+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-07-07T14:45:50.965+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
